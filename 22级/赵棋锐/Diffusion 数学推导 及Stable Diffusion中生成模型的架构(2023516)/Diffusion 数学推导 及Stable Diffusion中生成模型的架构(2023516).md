## 1.定义

扩散粒子从高浓度区域向低浓度区域移动的过程

![截图](c9ad379ceb16d9c7d3d8bb8dc75cab45.png)

## 2.大致的过程

向图片中不断地加入高斯噪声来模拟这种现象。

**==并且通过逆向过程从随机噪声中生成图片==**

![截图](c2b2886191aef3ed6b08b8ba23b9492f.png)

## 3.前向加噪

- 先将图片的像素通过归一化映射到【-1,1】的区间
- 随机采样生成一张同样大小的噪声图片（数值遵从标准正态分布）
- 归一化的图片和噪声图片进行混合
  
  <img src="7bc323c13b28133c57a3d205258704e0.png" alt="截图" style="zoom:50%;" />
- 前向加噪的总过程
  
  ![截图](61ac4f6c8659fa82e3f3d4ecdfdc2400.png)

- 前向加噪的公式进行简化
  
  ![截图](150c903af6e3a0439b6427abe949be7a.png)
  
  ![截图](4abab97511d024f08447ed157b4e337c.png)
  -  采样两次转化为在叠加的概率分布中采样一次
    
    对于两种概率模型进行卷积操作：计算两个分布的所有可能的组合情况
    
    h(x) = (f * g)(x) = ∫[−∞,∞] f(x − t)g(t) dt
    
    ![截图](aa82c17081bc6014d1cf4c6ec924d74e.png)
    
    所以能得到如上的情况
  - 用如上的方法叠加概率模型<img src="0068e7a4ae5618afa62ccab96b34db39.png" alt="截图" style="zoom:50%;" />和概率模型<img src="86aecc8d1f349015d737cc93d57860cc.png" alt="截图" style="zoom:50%;" />
    
    有得知：**==系数和标准差都会变成原来的系数倍==**
    
    所以，最终得到
    
    ![截图](c69536c07c64fa78647c418ce6adc133.png)
    
    ![截图](0639289b5828c14fa9a0e2f68fd4ba6b.png)
  - 用数学归纳法进行推导，得出
    
    ![截图](981028cb050288271dd6c4eb1b0dfb53.png)
    
    简化<img src="e89d3584c2edb672ce56cfe27b8b9c24.png" alt="截图" style="zoom:50%;" />得出
    
    ![截图](a49bb4cf43dd0795efc9b38b947b6d76.png)
    
    以上就是前向加噪的全部过程

## 3.反向过程

- 目标：从xT的噪声图片中回复得到x0时刻的原图
- 关于贝叶斯公式
  
  ![截图](7692fd209e03422a0d74c5581bc4ae4f.png)
  - P(A):先验概率：表示基于经验的A事件发生的概率
  - P(A|B):后验概率： 表示基于事实B后事件A发生的概率（反向）
  - P(B|A):归因力度： A事件发生后发生B事件（正向）
  
  xt-1时刻到xt时刻是一个随机的过程
  
  所以得到这个公式
  
  <img src="c324dd54c95652446ab0f952acb60636.png" alt="截图" style="zoom:50%;" />
  
  <img src="24d5443462507e180ac3aa37bbfc6c05.png" alt="截图" style="zoom:50%;" />
  
  所以对于P(xt|xt-1)和P(xt|x0)来说
  
  ![截图](84247bda349e3d4ece834c7cbe70690c.png)
  
  ![截图](b9762a73d0dca374338c6bd7ae112c87.png)
  
  ![截图](400c51f9eb833a76922d1dd0e28ba4a3.png)
  
  ![截图](e3bac75604879a69b2571a202870d5ee.png)
  
  ![截图](9eb34f2d31c42972c49e5fa28f17f7ca.png)
  
  ![截图](f0a2971dd139cc06d5efb84d9e51b1c7.png)
  
  把x0用xt进行替换
  
  ![截图](215c9f4d8e6e5a25c536de07123ccc74.png)
  
  **==对于任意一个xt的图像，都可以认为是由x0原图直接加噪而来的==**

## 训练的方向

输入一个xt的图像，来预测相对于某个x0原图所加入的噪声

![截图](aa085e34db843344e127a5fe1c9fdcdb.png)

## 训练的过程

![截图](6c3c21a80924235d6a5c602ded3e11e7.png)

## 推导的过程

![截图](54946dfd2909bc13359ca40404adcc85.png)